<div class="checkout-container">
  <div class="checkout-header">
    <h1>Checkout</h1>
  </div>

  <div class="checkout-layout">
    <!-- Main Content -->
    <div class="checkout-main">
      <!-- Step Indicator -->
      <div class="step-indicator">
        <div [class.active]="currentStep === 1" class="step">
          <span class="step-number">1</span>
          <span class="step-label">Delivery</span>
        </div>
        <div class="step-connector"></div>
        <div [class.active]="currentStep === 2" class="step">
          <span class="step-number">2</span>
          <span class="step-label">Payment</span>
        </div>
      </div>

      <!-- Step 1: Delivery Address -->
      <div class="step-content" *ngIf="currentStep === 1">
        <h2>Delivery Address</h2>
        <form [formGroup]="checkoutForm">
          <div class="form-group">
            <label for="deliveryAddress">Delivery Address</label>
            <textarea
              id="deliveryAddress"
              formControlName="deliveryAddress"
              placeholder="Enter your delivery address"
              class="form-control"
              rows="3"
            ></textarea>
            <div *ngIf="deliveryAddress?.errors && deliveryAddress?.touched" class="error">
              Address is required (min 10 characters)
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="city">City</label>
              <input
                type="text"
                id="city"
                formControlName="city"
                placeholder="Enter city"
                class="form-control"
              />
              <div *ngIf="city?.errors && city?.touched" class="error">
                City is required
              </div>
            </div>

            <div class="form-group">
              <label for="pincode">Pincode</label>
              <input
                type="text"
                id="pincode"
                formControlName="pincode"
                placeholder="Enter 6 digit pincode"
                class="form-control"
              />
              <div *ngIf="pincode?.errors && pincode?.touched" class="error">
                Valid 6 digit pincode required
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="phone">Phone Number</label>
            <input
              type="tel"
              id="phone"
              formControlName="phone"
              placeholder="Enter 10 digit phone number"
              class="form-control"
            />
          </div>

          <div class="form-group">
            <label for="specialInstructions">Special Instructions (Optional)</label>
            <textarea
              id="specialInstructions"
              formControlName="specialInstructions"
              placeholder="Any special instructions for delivery?"
              class="form-control"
              rows="2"
            ></textarea>
          </div>

          <div class="button-group">
            <button type="button" (click)="nextStep()" class="btn btn-primary">
              Continue to Payment
            </button>
          </div>
        </form>
      </div>

      <!-- Step 2: Payment -->
      <div class="step-content" *ngIf="currentStep === 2">
        <h2>Payment Method</h2>
        <form [formGroup]="paymentForm">
          <div class="payment-methods">
            <div 
              *ngFor="let method of paymentMethods"
              class="payment-method"
              [class.selected]="paymentForm.get('paymentMethod')?.value === method.id"
              (click)="paymentForm.patchValue({paymentMethod: method.id})"
            >
              <span class="method-icon">{{ method.icon }}</span>
              <span class="method-name">{{ method.name }}</span>
            </div>
          </div>

          <div *ngIf="paymentForm.get('paymentMethod')?.value === 'card'" class="card-details">
            <h3>Card Details</h3>
            <div class="form-group">
              <label for="cardHolder">Card Holder Name</label>
              <input
                type="text"
                id="cardHolder"
                formControlName="cardHolder"
                placeholder="Enter card holder name"
                class="form-control"
              />
            </div>

            <div class="form-group">
              <label for="cardNumber">Card Number</label>
              <input
                type="text"
                id="cardNumber"
                formControlName="cardNumber"
                placeholder="Enter 16 digit card number"
                class="form-control"
                maxlength="16"
              />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="expiryDate">Expiry Date</label>
                <input
                  type="text"
                  id="expiryDate"
                  formControlName="expiryDate"
                  placeholder="MM/YY"
                  class="form-control"
                  maxlength="5"
                />
              </div>
              <div class="form-group">
                <label for="cvv">CVV</label>
                <input
                  type="password"
                  id="cvv"
                  formControlName="cvv"
                  placeholder="3 digit CVV"
                  class="form-control"
                  maxlength="3"
                />
              </div>
            </div>
          </div>

          <div class="button-group">
            <button type="button" (click)="previousStep()" class="btn btn-secondary">
              Back
            </button>
            <button 
              type="button" 
              (click)="placeOrder()" 
              [disabled]="loading"
              class="btn btn-primary"
            >
              {{ loading ? 'Processing...' : 'Place Order' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Order Summary Sidebar -->
    <div class="order-summary">
      <h3>Order Summary</h3>
      <div class="summary-items">
        <div class="summary-item" *ngFor="let item of cartItems">
          <div class="item-name">{{ item.name }} x {{ item.quantity }}</div>
          <div class="item-price">₹{{ item.price * item.quantity }}</div>
        </div>
      </div>

      <div class="summary-divider"></div>

      <div class="summary-detail">
        <span>Subtotal:</span>
        <span>₹{{ totalPrice }}</span>
      </div>
      <div class="summary-detail">
        <span>Delivery:</span>
        <span>₹50</span>
      </div>
      <div class="summary-detail">
        <span>Tax:</span>
        <span>₹{{ (totalPrice * 0.05).toFixed(2) }}</span>
      </div>

      <div class="summary-divider"></div>

      <div class="summary-total">
        <span>Total:</span>
        <span>₹{{ (totalPrice + 50 + (totalPrice * 0.05)).toFixed(2) }}</span>
      </div>
    </div>
  </div>
</div>
