<div class="addresses-container">
  <div class="addresses-header">
    <h2>My Addresses</h2>
    <button class="btn btn-primary" (click)="toggleAddressForm()">
      {{ showAddressForm ? 'âœ• Cancel' : '+ Add New Address' }}
    </button>
  </div>

  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <!-- Add/Edit Address Form -->
  <div *ngIf="showAddressForm" class="address-form-container">
    <h3>{{ editingAddressId ? 'Edit Address' : 'Add New Address' }}</h3>
    <form [formGroup]="addressForm" (ngSubmit)="saveAddress()">
      <div class="form-row">
        <div class="form-group">
          <label for="label">Address Label</label>
          <select id="label" formControlName="label" class="form-control">
            <option value="">Select label</option>
            <option value="Home">Home</option>
            <option value="Work">Work</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div class="form-group">
          <label for="mobileNumber">Mobile Number</label>
          <input
            type="tel"
            id="mobileNumber"
            formControlName="mobileNumber"
            class="form-control"
            placeholder="10-digit mobile number"
            [class.is-invalid]="submitted && addressForm.get('mobileNumber')?.invalid"
          />
        </div>
      </div>

      <div class="form-group">
        <label for="street">Street Address</label>
        <input
          type="text"
          id="street"
          formControlName="street"
          class="form-control"
          placeholder="Enter street address"
          [class.is-invalid]="submitted && addressForm.get('street')?.invalid"
        />
      </div>

      <div class="form-group">
        <label for="landmark">Landmark (Optional)</label>
        <input
          type="text"
          id="landmark"
          formControlName="landmark"
          class="form-control"
          placeholder="e.g., Near hospital, opposite park"
        />
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="city">City</label>
          <input
            type="text"
            id="city"
            formControlName="city"
            class="form-control"
            placeholder="City"
            [class.is-invalid]="submitted && addressForm.get('city')?.invalid"
          />
        </div>
        <div class="form-group">
          <label for="state">State</label>
          <input
            type="text"
            id="state"
            formControlName="state"
            class="form-control"
            placeholder="State"
            [class.is-invalid]="submitted && addressForm.get('state')?.invalid"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="zipCode">ZIP Code</label>
          <input
            type="text"
            id="zipCode"
            formControlName="zipCode"
            class="form-control"
            placeholder="5-digit ZIP code"
            [class.is-invalid]="submitted && addressForm.get('zipCode')?.invalid"
          />
        </div>
        <div class="form-group">
          <label for="country">Country</label>
          <input
            type="text"
            id="country"
            formControlName="country"
            class="form-control"
            placeholder="Country"
            [class.is-invalid]="submitted && addressForm.get('country')?.invalid"
          />
        </div>
      </div>

      <div class="form-checkbox">
        <input
          type="checkbox"
          id="isDefault"
          formControlName="isDefault"
        />
        <label for="isDefault">Set as default address</label>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="loading">
          {{ loading ? 'Saving...' : 'Save Address' }}
        </button>
        <button type="button" class="btn btn-secondary" (click)="cancelEdit()">
          Cancel
        </button>
      </div>
    </form>
  </div>

  <!-- Addresses List -->
  <div class="addresses-list">
    <div *ngIf="addresses.length === 0" class="empty-state">
      <p>ğŸ“ No addresses found. Add your first address to get started!</p>
    </div>

    <div *ngFor="let address of addresses" class="address-card">
      <div class="address-header">
        <h4>{{ address.label }}</h4>
        <span *ngIf="address.isDefault" class="badge">Default</span>
      </div>

      <div class="address-details">
        <p><strong>{{ address.street }}</strong></p>
        <p>{{ address.landmark }}</p>
        <p>{{ address.city }}, {{ address.state }} {{ address.zipCode }}, {{ address.country }}</p>
        <p>ğŸ“ {{ address.mobileNumber }}</p>
      </div>

      <div class="address-actions">
        <button class="btn-icon" (click)="editAddress(address)" title="Edit">
          âœï¸ Edit
        </button>
        <button class="btn-icon" *ngIf="!address.isDefault" (click)="setDefault(address.id!)" title="Set as default">
          â­ Set Default
        </button>
        <button class="btn-icon danger" (click)="deleteAddress(address.id!)" title="Delete">
          ğŸ—‘ï¸ Delete
        </button>
      </div>
    </div>
  </div>
</div>
